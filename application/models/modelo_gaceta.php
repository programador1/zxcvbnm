<?php

class modelo_gaceta extends CI_Model {
    function __construct() {
        parent::__construct();
    }
    
    

    ///////////////////// CONSULTAS PARA SABER REPORTE DE CONCESIONES CON PAGOS INCOMPLETOS
     function pago_patentesDobles($id_concesion_minera, $gestion){
        $sql="
                SELECT importe_gestion, SUM(importe) AS importe, max(fecha_pago::date) AS fecha_pago
                FROM patentes
                WHERE id_concesion_minera = '$id_concesion_minera'
                      AND importe_gestion = '$gestion'
                GROUP BY importe_gestion
        ";
        $consulta = $this->db->query($sql);
        //echo $sql; exit();
        if ($consulta->num_rows() > 0)
            return $consulta->row();
        else
            return FALSE;
    }
    
    function datos_importe($fecha_pago){
        $sql="
                SELECT *
                FROM importe_patente
                WHERE   fecha_inicio_pago <= '$fecha_pago'
                        AND fecha_final_pago >= '$fecha_pago'
        ";
        $consulta = $this->db->query($sql);
        //echo $sql; exit();
        if ($consulta->num_rows() > 0)
            return $consulta->row();
        else
            return FALSE;
    }
    
    function listar_cuadriculas(){
        $sql="
               SELECT 	conmin.*
                FROM 	vista_concesion_minera AS conmin	
                WHERE	conmin.tipo_concesion = 'CUADRICULA'
                        AND conmin.numero_formulario IN ('28129', '28118', '21486', '9006', '21451', '13685', '1000316', '12221', '18320', '28170', '9146', '29946', '18311', '22391', '1000832', '9010', '9118', '23903', '20169', '29952', '22108', '28125', '25838', '11349', '25837', '9045', '1000343', '28138', '31177', '21877', '9028', '22382', '13795', '1000870', '28501', '30358', '12137', '11769', '25987', '18863', '1001064', '1000656', '1001314', '28446', '31132', '19984', '26411', '30257', '1001357', '31602', '21021', '23716', '31553', '31054', '1000853', '31098', '1002405', '28745', '31554', '1000838', '1000760', '26412', '22487', '22920', '1001399', '31139', '23120', '1001057', '25232', '1001461', '31049', '1000866', '1001627', '21063', '29751', '21006', '1000975', '1000947', '21982', '30999', '30348', '30346', '18453', '1001541', '31074', '10265', '1000887', '1001042', '22273', '28637', '23703', '1001454', '18025', '29312', '26035', '1000893', '18679', '30256', '29647', '23072', '31115', '1000695', '19713', '20025', '20245', '1001534', '1001604', '16450', '20782', '30871', '24214', '1000918', '29318', '22302', '13628', '31586', '1001471', '11978', '1000849', '1001345', '1001859', '29336', '29334', '19732', '24334', '27879', '21603', '766', '21829', '31570', '24329', '1000812', '29474', '20786', '23572', '31073', '15826', '90645', '20280', '30255', '23130', '28649', '26773', '29992', '25621', '26502', '28522', '23828', '15921', '10729', '25962', '27043', '27032', '30271', '6017', '30893', '30665', '24889', '24396', '24676', '30855', '29116', '30859', '29988', '16293', '28526', '19925', '29350', '18658', '25963', '24682', '26510', '24386', '15462', '30872', '18846', '25622', '27550', '28550', '30869', '30860', '18841', '29983', '24680', '26767', '25466', '19923', '28398', '21222', '90502', '90501', '14426', '6367', '30272', '20630', '16290', '1000064', '26513', '25467', '11215', '21107', '31362', '28528', '15930', '28523', '29986', '10727', '20625', '19339', '16296', '30274', '10764', '16252', '20461', '25135', '27109', '12978', '27737', '25509', '27704', '14182', '22433', '27108', '19419', '1001403', '23522', '24626', '20675', '29016', '12409', '26722', '20458', '22014', '28081', '16204', '24803', '31539', '1000104', '24256', '30634', '19037', '8136', '29650', '24843', '30600', '8267', '14168', '11907', '27945', '25885', '19774', '27110', '27087', '19277', '30614', '22075', '30944', '22700', '1001200', '29018', '18378', '8017', '30561', '22704', '1001193', '24006', '24395', '8226', '24007', '1001211', '8199', '27983', '23634', '25132', '30141', '1000103', '30104', '21108', '27917', '18510', '32137', '23345', '29091', '21718', '15415', '25101', '26770', '27131', '14183', '27154', '30635', '25502', '16823', '24250', '30965', '8586', '31540', '16627', '24811', '30604', '10598', '21730', '28218', '26899', '12292', '13453', '5323', '30200', '22758', '25582', '28275', '30218', '22097', '1000917', '30199', '25338', '5107', '28259', '26065', '16744', '16170', '28271', '25583', '26490', '27281', '12293', '14308', '16163', '25790', '19072', '1000452', '25166', '30224', '12553', '21001', '27278', '28809', '27019', '90106', '12069', '1000029', '28239', '20194', '12269', '18985', '5525', '12050', '22753', '27011', '30238', '19002', '30196', '31684', '23870', '25613', '28368', '25165', '24137', '30198', '29600', '23864', '22677', '30242', '12043', '14460', '16143', '27802', '16785', '25791', '22729', '28789', '27280', '27279', '12573', '5398', '23841', '1000031', '22410', '5361', '27780', '12265', '12268', '30232', '15665', '29601', '90104', '22746', '28393', '31699', '12575', '29625', '27018', '5324', '28233', '18986', '12020', '25356', '15886', '26897', '19014', '5341', '25614', '28235', '20205', '31661', '21372', '25354', '12270', '28258', '12267', '25337', '30208', '30197', '12572', '12058', '25819', '26074', '15735', '1002156', '29689', '30064', '26633', '31243', '30511', '19958', '31416', '15300', '1001271', '13202', '24489', '1000278', '30524', '11092', '24761', '27589', '22169', '20079', '28303', '29694', '31828', '26573', '29692', '23393', '18107', '24788', '26137', '1001269', '12398', '29901', '27220', '23228', '30038', '27241', '20779', '25727', '30069', '30042', '28341', '1001413', '20360', '22199', '31827', '30323', '27580', '26231', '24753', '19395', '19953', '30041', '1001366', '26210', '24787', '31736', '19959', '1000279', '30487', '30286', '23206', '1001310', '7077', '20074', '19818', '31791', '21924', '31745', '25084', '24581', '1001289', '29688', '31192', '24496', '23418', '27204', '25002', '24072', '23207', '1002405', '1002374', '1001880', '1002445', '1001604', '1001775', '1001859', '1001042', '1000975', '1001733', '1001269', '1001413', '1002156')
                ORDER BY conmin.regional, conmin.numero_formulario
        ";
        $consulta = $this->db->query($sql);
        if ($consulta->num_rows() > 0)
            return $consulta;
        else
            return FALSE;
    }
    
    function listar_pertenencias(){
        $sql="
               SELECT 	conmin.*
                FROM 	vista_concesion_minera AS conmin	
                WHERE	conmin.tipo_concesion = 'CUADRICULA'
                        AND conmin.numero_formulario IN ('28129', '28118', '21486', '9006', '21451', '13685', '1000316', '12221', '18320', '28170', '9146', '29946', '18311', '22391', '1000832', '9010', '9118', '23903', '20169', '29952', '22108', '28125', '25838', '11349', '25837', '9045', '1000343', '28138', '31177', '21877', '9028', '22382', '13795', '1000870', '28501', '30358', '12137', '11769', '25987', '18863', '1001064', '1000656', '1001314', '28446', '31132', '19984', '26411', '30257', '1001357', '31602', '21021', '23716', '31553', '31054', '1000853', '31098', '1002405', '28745', '31554', '1000838', '1000760', '26412', '22487', '22920', '1001399', '31139', '23120', '1001057', '25232', '1001461', '31049', '1000866', '1001627', '21063', '29751', '21006', '1000975', '1000947', '21982', '30999', '30348', '30346', '18453', '1001541', '31074', '10265', '1000887', '1001042', '22273', '28637', '23703', '1001454', '18025', '29312', '26035', '1000893', '18679', '30256', '29647', '23072', '31115', '1000695', '19713', '20025', '20245', '1001534', '1001604', '16450', '20782', '30871', '24214', '1000918', '29318', '22302', '13628', '31586', '1001471', '11978', '1000849', '1001345', '1001859', '29336', '29334', '19732', '24334', '27879', '21603', '766', '21829', '31570', '24329', '1000812', '29474', '20786', '23572', '31073', '15826', '90645', '20280', '30255', '23130', '28649', '26773', '29992', '25621', '26502', '28522', '23828', '15921', '10729', '25962', '27043', '27032', '30271', '6017', '30893', '30665', '24889', '24396', '24676', '30855', '29116', '30859', '29988', '16293', '28526', '19925', '29350', '18658', '25963', '24682', '26510', '24386', '15462', '30872', '18846', '25622', '27550', '28550', '30869', '30860', '18841', '29983', '24680', '26767', '25466', '19923', '28398', '21222', '90502', '90501', '14426', '6367', '30272', '20630', '16290', '1000064', '26513', '25467', '11215', '21107', '31362', '28528', '15930', '28523', '29986', '10727', '20625', '19339', '16296', '30274', '10764', '16252', '20461', '25135', '27109', '12978', '27737', '25509', '27704', '14182', '22433', '27108', '19419', '1001403', '23522', '24626', '20675', '29016', '12409', '26722', '20458', '22014', '28081', '16204', '24803', '31539', '1000104', '24256', '30634', '19037', '8136', '29650', '24843', '30600', '8267', '14168', '11907', '27945', '25885', '19774', '27110', '27087', '19277', '30614', '22075', '30944', '22700', '1001200', '29018', '18378', '8017', '30561', '22704', '1001193', '24006', '24395', '8226', '24007', '1001211', '8199', '27983', '23634', '25132', '30141', '1000103', '30104', '21108', '27917', '18510', '32137', '23345', '29091', '21718', '15415', '25101', '26770', '27131', '14183', '27154', '30635', '25502', '16823', '24250', '30965', '8586', '31540', '16627', '24811', '30604', '10598', '21730', '28218', '26899', '12292', '13453', '5323', '30200', '22758', '25582', '28275', '30218', '22097', '1000917', '30199', '25338', '5107', '28259', '26065', '16744', '16170', '28271', '25583', '26490', '27281', '12293', '14308', '16163', '25790', '19072', '1000452', '25166', '30224', '12553', '21001', '27278', '28809', '27019', '90106', '12069', '1000029', '28239', '20194', '12269', '18985', '5525', '12050', '22753', '27011', '30238', '19002', '30196', '31684', '23870', '25613', '28368', '25165', '24137', '30198', '29600', '23864', '22677', '30242', '12043', '14460', '16143', '27802', '16785', '25791', '22729', '28789', '27280', '27279', '12573', '5398', '23841', '1000031', '22410', '5361', '27780', '12265', '12268', '30232', '15665', '29601', '90104', '22746', '28393', '31699', '12575', '29625', '27018', '5324', '28233', '18986', '12020', '25356', '15886', '26897', '19014', '5341', '25614', '28235', '20205', '31661', '21372', '25354', '12270', '28258', '12267', '25337', '30208', '30197', '12572', '12058', '25819', '26074', '15735', '1002156', '29689', '30064', '26633', '31243', '30511', '19958', '31416', '15300', '1001271', '13202', '24489', '1000278', '30524', '11092', '24761', '27589', '22169', '20079', '28303', '29694', '31828', '26573', '29692', '23393', '18107', '24788', '26137', '1001269', '12398', '29901', '27220', '23228', '30038', '27241', '20779', '25727', '30069', '30042', '28341', '1001413', '20360', '22199', '31827', '30323', '27580', '26231', '24753', '19395', '19953', '30041', '1001366', '26210', '24787', '31736', '19959', '1000279', '30487', '30286', '23206', '1001310', '7077', '20074', '19818', '31791', '21924', '31745', '25084', '24581', '1001289', '29688', '31192', '24496', '23418', '27204', '25002', '24072', '23207', '1002405', '1002374', '1001880', '1002445', '1001604', '1001775', '1001859', '1001042', '1000975', '1001733', '1001269', '1001413', '1002156')
                ORDER BY conmin.regional, conmin.numero_formulario
        ";
        $consulta = $this->db->query($sql);
        if ($consulta->num_rows() > 0)
            return $consulta;
        else
            return FALSE;
    }
    
    
}